{"version":3,"sources":["../../../../server/auth/twitter/passport.js"],"names":[],"mappings":";;;;;QAGgB,K,GAAA,K;;AAHhB;;;;AACA;;;;AAEO,SAAS,KAAT,CAAe,IAAf,EAAqB,MAArB,EAA6B;AAClC,qBAAS,GAAT,CAAa,8BAAoB;AAC/B,iBAAa,OAAO,OAAP,CAAe,QADG;AAE/B,oBAAgB,OAAO,OAAP,CAAe,YAFA;AAG/B,iBAAa,OAAO,OAAP,CAAe;AAHG,GAApB,EAKb,UAAS,KAAT,EAAgB,WAAhB,EAA6B,OAA7B,EAAsC,IAAtC,EAA4C;AAC1C,SAAK,OAAL,CAAa,EAAC,cAAc,QAAQ,EAAvB,EAAb,EAAyC,IAAzC,GACG,IADH,CACQ,gBAAQ;AACZ,UAAI,IAAJ,EAAU;AACR,eAAO,KAAK,IAAL,EAAW,IAAX,CAAP;AACD;;AAED,aAAO,IAAI,IAAJ,CAAS;AACd,cAAM,QAAQ,WADA;AAEd,kBAAU,QAAQ,QAFJ;AAGd,cAAM,MAHQ;AAId,kBAAU,SAJI;AAKd,iBAAS,QAAQ;AALH,OAAT,CAAP;AAOA,WAAK,IAAL,GACG,IADH,CACQ;AAAA,eAAQ,KAAK,IAAL,EAAW,IAAX,CAAR;AAAA,OADR,EAEG,KAFH,CAES;AAAA,eAAO,KAAK,GAAL,CAAP;AAAA,OAFT;AAGD,KAhBH,EAiBG,KAjBH,CAiBS;AAAA,aAAO,KAAK,GAAL,CAAP;AAAA,KAjBT;AAkBD,GAxBY,CAAb;AAyBD","file":"passport.js","sourcesContent":["import passport from 'passport';\nimport {Strategy as TwitterStrategy} from 'passport-twitter';\n\nexport function setup(User, config) {\n  passport.use(new TwitterStrategy({\n    consumerKey: config.twitter.clientID,\n    consumerSecret: config.twitter.clientSecret,\n    callbackURL: config.twitter.callbackURL\n  },\n  function(token, tokenSecret, profile, done) {\n    User.findOne({'twitter.id': profile.id}).exec()\n      .then(user => {\n        if (user) {\n          return done(null, user);\n        }\n\n        user = new User({\n          name: profile.displayName,\n          username: profile.username,\n          role: 'user',\n          provider: 'twitter',\n          twitter: profile._json\n        });\n        user.save()\n          .then(user => done(null, user))\n          .catch(err => done(err));\n      })\n      .catch(err => done(err));\n  }));\n}\n"]}